-----BEGIN-----
-----SETTINGS-----
STRATEGY:feddf
MODEL_NAME:resnet8
NUM_CLIENTS:20
NUM_ROUNDS:10
FRACTION_FIT:0.4
FRACTION_EVALUATE:0.0
DATASET_NAME:cifar10
PARTITION_ALPHA:1.0
PARTITION_VAL_RATIO:0.1
BATCH_SIZE:1024
LOCAL_EPOCHS:80
LOCAL_LR:0.3
DISTILL_BATCH_SIZE:1024
SERVER_LR:0.003
SERVER_STEPS:500
SERVER_EARLY_STEPS:1000
USE_EARLY_STOPPING:False
USE_ADAPTIVE_LR:False
SEED:42
CUDA_DETERMINISTIC:False
USE_CROPS:True
IMG_NAME:ameyoko.jpg
DISTILL_DATASET:cifar100
DISTILL_ALPHA:1.0
NUM_DISTILL_IMAGES:2250
WARM_START:False
WARM_START_ROUNDS:5
WARM_START_INTERVAL:5
DEBUG:False
-----SETTINGS END-----
-----EXPERIMENT BEGINS-----
---------
Generating crops for FedDF
Namespace(img_size=32, batch_size=32, num_imgs=2250, threads=12, vflip=False, deg=30, shear=30, cropfirst=True, initcrop=0.5, scale=[500, 1], randinterp=False, debug=False, imgpath='./static/single_images/ameyoko.jpg', targetpath='/scratch-local/sunnys.2816640', seed=42, img_per_thread=187)
will save 2250 patches in /scratch-local/sunnys.2816640/single_img_crops/crops
2250 took 0.04min with 12 threads
---------
Simulating feddf training
INFO flwr 2023-05-30 12:52:12,387 | app.py:145 | Starting Flower simulation, config: ServerConfig(num_rounds=10, round_timeout=None)
2023-05-30 12:52:14,652	INFO worker.py:1529 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
INFO flwr 2023-05-30 12:52:18,680 | app.py:179 | Flower VCE: Ray initialized with resources: {'CPU': 72.0, 'accelerator_type:A100': 1.0, 'GPU': 1.0, 'memory': 355500508980.0, 'object_store_memory': 156643075276.0, 'node:145.136.62.47': 1.0}
INFO flwr 2023-05-30 12:52:18,680 | server.py:86 | Initializing global parameters
INFO flwr 2023-05-30 12:52:18,680 | server.py:266 | Using initial parameters provided by strategy
INFO flwr 2023-05-30 12:52:18,680 | server.py:88 | Evaluating initial parameters
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch-local/sunnys.2816640/cifar-10-python.tar.gz
Extracting /scratch-local/sunnys.2816640/cifar-10-python.tar.gz to /scratch-local/sunnys.2816640
Generating unified cifar10 dataset
Class histogram for 0-th partition (alpha=1.0, 10 classes): [440 381 415  39  10 257 227 532  17 182]
INFO flwr 2023-05-30 12:52:23,053 | server.py:91 | initial parameters (loss, other metrics): 2.323421728515625, {'server_test_acc': 0.108}
INFO flwr 2023-05-30 12:52:23,054 | server.py:101 | FL starting
DEBUG flwr 2023-05-30 12:52:23,054 | server.py:215 | fit_round 1: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-05-30 12:53:13,778 | server.py:229 | fit_round 1 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=496961)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=496967)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=496965)[0m Fitting Client 11
[2m[36m(launch_and_fit pid=496971)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=496970)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=496968)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=496969)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=496972)[0m Fitting Client 14
Performing server side distillation training...
Distillation training stopped at step number : 500
Average fusion training loss : 0.018940523700788615, val accuracy : 0.24393999999999996, best val accuracy : 0.2608
Average local training loss : 4.900742649286985
Average local training accuracy : 0.4503625
INFO flwr 2023-05-30 12:53:51,044 | server.py:116 | fit progress: (1, 1.8716023193359375, {'server_test_acc': 0.2766}, 87.99020780809224)
INFO flwr 2023-05-30 12:53:51,044 | server.py:163 | evaluate_round 1: no clients selected, cancel
DEBUG flwr 2023-05-30 12:53:51,044 | server.py:215 | fit_round 2: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-05-30 12:54:43,770 | server.py:229 | fit_round 2 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=619322)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=619320)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=619321)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=619327)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=619326)[0m Fitting Client 19
[2m[36m(launch_and_fit pid=619325)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=619323)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=619324)[0m Fitting Client 17
Performing server side distillation training...
Distillation training stopped at step number : 500
Average fusion training loss : 0.016653693293221295, val accuracy : 0.2427, best val accuracy : 0.2594
Average local training loss : 4.43546435246244
Average local training accuracy : 0.4828416666666667
INFO flwr 2023-05-30 12:55:21,484 | server.py:116 | fit progress: (2, 2.5073949951171874, {'server_test_acc': 0.2601}, 178.430829155026)
INFO flwr 2023-05-30 12:55:21,485 | server.py:163 | evaluate_round 2: no clients selected, cancel
DEBUG flwr 2023-05-30 12:55:21,485 | server.py:215 | fit_round 3: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-05-30 12:56:13,485 | server.py:229 | fit_round 3 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=741579)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=741580)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=741584)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=741582)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=741585)[0m Fitting Client 1
[2m[36m(launch_and_fit pid=741586)[0m Fitting Client 0
[2m[36m(launch_and_fit pid=741587)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=741583)[0m Fitting Client 3
Performing server side distillation training...
Distillation training stopped at step number : 500
Average fusion training loss : 0.015571132340468466, val accuracy : 0.32898, best val accuracy : 0.3388
Average local training loss : 4.886978700943291
Average local training accuracy : 0.4126152777777778
INFO flwr 2023-05-30 12:56:51,530 | server.py:116 | fit progress: (3, 1.7679835571289062, {'server_test_acc': 0.3401}, 268.4763199589215)
INFO flwr 2023-05-30 12:56:51,530 | server.py:163 | evaluate_round 3: no clients selected, cancel
DEBUG flwr 2023-05-30 12:56:51,530 | server.py:215 | fit_round 4: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-05-30 12:57:44,166 | server.py:229 | fit_round 4 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=863922)[0m Fitting Client 11
[2m[36m(launch_and_fit pid=863917)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=863923)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=863920)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=863919)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=863918)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=863921)[0m Fitting Client 9
[2m[36m(launch_and_fit pid=863924)[0m Fitting Client 6
Performing server side distillation training...
E0530 12:57:51.819858505  962793 chttp2_transport.cc:1079]             ipv4:145.136.62.47:41489: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 60000ms
Distillation training stopped at step number : 500
Average fusion training loss : 0.014735191299580038, val accuracy : 0.33846, best val accuracy : 0.3498
Average local training loss : 4.880418614577502
Average local training accuracy : 0.4359180555555555
INFO flwr 2023-05-30 12:58:22,294 | server.py:116 | fit progress: (4, 1.653949169921875, {'server_test_acc': 0.3515}, 359.24014974199235)
INFO flwr 2023-05-30 12:58:22,294 | server.py:163 | evaluate_round 4: no clients selected, cancel
DEBUG flwr 2023-05-30 12:58:22,294 | server.py:215 | fit_round 5: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-05-30 12:59:15,683 | server.py:229 | fit_round 5 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=986323)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=986321)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=986327)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=986325)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=986328)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=986329)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=986326)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=986330)[0m Fitting Client 4
Performing server side distillation training...
Distillation training stopped at step number : 500
Average fusion training loss : 0.22335233841091395, val accuracy : 0.19032, best val accuracy : 0.2312
Average local training loss : 4.944123633950948
Average local training accuracy : 0.4112298611111111
INFO flwr 2023-05-30 12:59:54,166 | server.py:116 | fit progress: (5, 2.310547839355469, {'server_test_acc': 0.2407}, 451.1125575029291)
INFO flwr 2023-05-30 12:59:54,166 | server.py:163 | evaluate_round 5: no clients selected, cancel
DEBUG flwr 2023-05-30 12:59:54,166 | server.py:215 | fit_round 6: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-05-30 13:00:48,124 | server.py:229 | fit_round 6 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=1108613)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=1108609)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=1108615)[0m Fitting Client 9
[2m[36m(launch_and_fit pid=1108616)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=1108611)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=1108612)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=1108614)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=1108610)[0m Fitting Client 7
Performing server side distillation training...
Distillation training stopped at step number : 500
Average fusion training loss : 0.04660417108982801, val accuracy : 0.24298000000000003, best val accuracy : 0.2524
Average local training loss : 4.3238316744565966
Average local training accuracy : 0.4829305555555556
INFO flwr 2023-05-30 13:01:27,038 | server.py:116 | fit progress: (6, 2.6826283203125, {'server_test_acc': 0.261}, 543.9842107619625)
INFO flwr 2023-05-30 13:01:27,038 | server.py:163 | evaluate_round 6: no clients selected, cancel
DEBUG flwr 2023-05-30 13:01:27,038 | server.py:215 | fit_round 7: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-05-30 13:02:20,065 | server.py:229 | fit_round 7 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=1231014)[0m Fitting Client 4
[2m[36m(launch_and_fit pid=1231016)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=1231019)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=1231021)[0m Fitting Client 1
[2m[36m(launch_and_fit pid=1231015)[0m Fitting Client 11
[2m[36m(launch_and_fit pid=1231018)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=1231020)[0m Fitting Client 0
[2m[36m(launch_and_fit pid=1231017)[0m Fitting Client 16
Performing server side distillation training...
Distillation training stopped at step number : 500
Average fusion training loss : 0.12232157963514328, val accuracy : 0.24820000000000003, best val accuracy : 0.2656
Average local training loss : 4.586996092647314
Average local training accuracy : 0.4384118055555555
INFO flwr 2023-05-30 13:02:59,275 | server.py:116 | fit progress: (7, 2.159309167480469, {'server_test_acc': 0.2642}, 636.2215185610112)
INFO flwr 2023-05-30 13:02:59,275 | server.py:163 | evaluate_round 7: no clients selected, cancel
DEBUG flwr 2023-05-30 13:02:59,275 | server.py:215 | fit_round 8: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-05-30 13:03:51,767 | server.py:229 | fit_round 8 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=1374468)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=1374474)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=1374469)[0m Fitting Client 4
[2m[36m(launch_and_fit pid=1374471)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=1374475)[0m Fitting Client 9
[2m[36m(launch_and_fit pid=1374472)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=1374470)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=1374473)[0m Fitting Client 6
Performing server side distillation training...
Distillation training stopped at step number : 500
Average fusion training loss : 0.0392152829580009, val accuracy : 0.26798, best val accuracy : 0.275
Average local training loss : 4.616771858464927
Average local training accuracy : 0.45151597222222223
INFO flwr 2023-05-30 13:04:30,900 | server.py:116 | fit progress: (8, 1.7895043701171875, {'server_test_acc': 0.2803}, 727.8465999050532)
INFO flwr 2023-05-30 13:04:30,900 | server.py:163 | evaluate_round 8: no clients selected, cancel
DEBUG flwr 2023-05-30 13:04:30,901 | server.py:215 | fit_round 9: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-05-30 13:05:26,840 | server.py:229 | fit_round 9 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=1497271)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=1497272)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=1497270)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=1497273)[0m Fitting Client 0
[2m[36m(launch_and_fit pid=1497274)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=1497275)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=1497276)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=1497269)[0m Fitting Client 14
Performing server side distillation training...
Distillation training stopped at step number : 500
Average fusion training loss : 0.05370585330575704, val accuracy : 0.24342000000000003, best val accuracy : 0.2546
Average local training loss : 4.362874597124756
Average local training accuracy : 0.47400972222222215
INFO flwr 2023-05-30 13:06:06,068 | server.py:116 | fit progress: (9, 2.192493896484375, {'server_test_acc': 0.2641}, 823.0146901078988)
INFO flwr 2023-05-30 13:06:06,068 | server.py:163 | evaluate_round 9: no clients selected, cancel
DEBUG flwr 2023-05-30 13:06:06,069 | server.py:215 | fit_round 10: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-05-30 13:07:00,373 | server.py:229 | fit_round 10 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=1619592)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=1619591)[0m Fitting Client 9
[2m[36m(launch_and_fit pid=1619594)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=1619590)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=1619596)[0m Fitting Client 0
[2m[36m(launch_and_fit pid=1619589)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=1619595)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=1619593)[0m Fitting Client 7
Performing server side distillation training...
E0530 13:07:08.220401755 1718240 chttp2_transport.cc:1079]             ipv4:145.136.62.47:41489: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 120000ms
Distillation training stopped at step number : 500
Average fusion training loss : 0.38145426112413405, val accuracy : 0.16086, best val accuracy : 0.2154
Average local training loss : 4.430052354279906
Average local training accuracy : 0.4706548611111111
INFO flwr 2023-05-30 13:07:39,782 | server.py:116 | fit progress: (10, 2.028470593261719, {'server_test_acc': 0.2186}, 916.7288313889876)
INFO flwr 2023-05-30 13:07:39,783 | server.py:163 | evaluate_round 10: no clients selected, cancel
INFO flwr 2023-05-30 13:07:39,783 | server.py:144 | FL finished in 916.7290996639058
INFO flwr 2023-05-30 13:07:39,783 | app.py:202 | app_fit: losses_distributed []
INFO flwr 2023-05-30 13:07:39,783 | app.py:203 | app_fit: metrics_distributed {}
INFO flwr 2023-05-30 13:07:39,783 | app.py:204 | app_fit: losses_centralized [(0, 2.323421728515625), (1, 1.8716023193359375), (2, 2.5073949951171874), (3, 1.7679835571289062), (4, 1.653949169921875), (5, 2.310547839355469), (6, 2.6826283203125), (7, 2.159309167480469), (8, 1.7895043701171875), (9, 2.192493896484375), (10, 2.028470593261719)]
INFO flwr 2023-05-30 13:07:39,783 | app.py:205 | app_fit: metrics_centralized {'server_test_acc': [(0, 0.108), (1, 0.2766), (2, 0.2601), (3, 0.3401), (4, 0.3515), (5, 0.2407), (6, 0.261), (7, 0.2642), (8, 0.2803), (9, 0.2641), (10, 0.2186)]}
-----EXPERIMENT ENDS-----
-----END-----

JOB STATISTICS
==============
Job ID: 2816640
Cluster: snellius
User/Group: sunnys/sunnys
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 18
CPU Utilized: 00:34:54
CPU Efficiency: 12.04% of 04:49:48 core-walltime
Job Wall-clock time: 00:16:06
Memory Utilized: 22.94 GB
Memory Efficiency: 0.00% of 0.00 MB
