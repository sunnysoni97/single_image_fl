-----BEGIN-----
-----SETTINGS-----
STRATEGY:feddf
MODEL_NAME:resnet8
NUM_CLIENTS:20
NUM_ROUNDS:30
FRACTION_FIT:0.4
FRACTION_EVALUATE:0.0
DATASET_NAME:pathmnist
PARTITION_ALPHA:1.0
PARTITION_VAL_RATIO:0.1
BATCH_SIZE:512
LOCAL_EPOCHS:40
LOCAL_LR:0.05
DISTILL_BATCH_SIZE:512
SERVER_LR:0.005
SERVER_STEPS:500
SERVER_EARLY_STEPS:1000
USE_EARLY_STOPPING:False
USE_ADAPTIVE_LR:False
SEED:42
CUDA_DETERMINISTIC:False
USE_CROPS:True
IMG_NAME:colonpath_sample.jpg
DISTILL_DATASET:cifar100
DISTILL_ALPHA:1.0
NUM_DISTILL_IMAGES:10000
DISTILL_TRANSFORMS:v0
WARM_START:True
WARM_START_ROUNDS:1
WARM_START_INTERVAL:5
KMEANS_N_CLUSTER:20
KMEANS_HEURISTICS:easy
KMEANS_MIXED_FACTOR:50-50
CLIPPING_FACTOR:2.0
-----SETTINGS END-----
-----EXPERIMENT BEGINS-----
---------
Generating crops for FedDF
Namespace(img_size=32, batch_size=32, num_imgs=100000, threads=18, vflip=False, deg=30, shear=30, cropfirst=True, initcrop=0.5, scale=[500, 1], randinterp=False, debug=False, imgpath='./static/single_images/colonpath_sample.jpg', targetpath='/scratch-local/sunnys.3066752/1689336075_908450552', seed=42, img_per_thread=5555)
will save 100000 patches in /scratch-local/sunnys.3066752/1689336075_908450552/single_img_crops/crops
100000 took 0.40min with 18 threads
---------
Simulating feddf training
INFO simulate 2023-07-14 14:01:54,796 | simulate.py:50 | Python script started : simulate.py
DEBUG simulate 2023-07-14 14:01:54,796 | simulate.py:55 | Reading args from argument parser
Downloading https://zenodo.org/record/6496656/files/pathmnist.npz?download=1 to /scratch-local/sunnys.3066752/1689336075_908450552/pathmnist.npz
Generating unified pathmnist dataset
Class histogram for 0-th partition (alpha=1.0, 9 classes): [ 797  772  834   92   22  456  457 1046   24]
INFO flwr 2023-07-14 14:03:07,596 | app.py:145 | Starting Flower simulation, config: ServerConfig(num_rounds=30, round_timeout=None)
2023-07-14 14:03:10,364	INFO worker.py:1529 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8266 [39m[22m
INFO flwr 2023-07-14 14:03:11,721 | app.py:179 | Flower VCE: Ray initialized with resources: {'object_store_memory': 61847529062.0, 'CPU': 18.0, 'accelerator_type:A100': 1.0, 'node:145.136.62.16': 1.0, 'GPU': 1.0, 'memory': 103079215104.0}
INFO flwr 2023-07-14 14:03:11,721 | server.py:86 | Initializing global parameters
INFO flwr 2023-07-14 14:03:11,721 | server.py:266 | Using initial parameters provided by strategy
INFO flwr 2023-07-14 14:03:11,721 | server.py:88 | Evaluating initial parameters
INFO flwr 2023-07-14 14:03:17,042 | server.py:91 | initial parameters (loss, other metrics): 2.1845225108367154, {'server_test_acc': 0.11030640668523677}
INFO flwr 2023-07-14 14:03:17,043 | server.py:101 | FL starting
DEBUG flwr 2023-07-14 14:03:24,835 | server.py:215 | fit_round 1: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=2770953)[0m double free or corruption (fasttop)
DEBUG flwr 2023-07-14 14:04:40,664 | server.py:229 | fit_round 1 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=2770913)[0m malloc_consolidate(): invalid chunk size
Cluster score for round 1 = 1282.534423828125
[2m[36m(launch_and_fit pid=2770955)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=2770953)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=2770922)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=2770954)[0m Fitting Client 11
[2m[36m(launch_and_fit pid=2770913)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=2770940)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=2770914)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=2770951)[0m Fitting Client 8
Warm start at round 1
Performing server side distillation training...
[2m[36m(launch_and_fit pid=2770951)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2770914)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2770955)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2770922)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2770954)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2770940)[0m double free or corruption (fasttop)
E0714 14:04:44.325403535 2762773 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 60000ms
Distillation training stopped at step number : 500
Average fusion training loss : 0.6133506083488465, val accuracy : 0.4001111605157848, best val accuracy : 0.4246331702979102
Average local training loss : 9.002693515457214
Average local training accuracy : 0.747474537037037
INFO flwr 2023-07-14 14:05:34,374 | server.py:116 | fit progress: (1, 1.9129554785725797, {'server_test_acc': 0.34428969359331474}, 137.33179553999798)
INFO flwr 2023-07-14 14:05:34,375 | server.py:163 | evaluate_round 1: no clients selected, cancel
DEBUG flwr 2023-07-14 14:05:42,589 | server.py:215 | fit_round 2: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=3048482)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3048470)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3048481)[0m double free or corruption (fasttop)
DEBUG flwr 2023-07-14 14:06:57,171 | server.py:229 | fit_round 2 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=3048483)[0m corrupted size vs. prev_size in fastbins
Cluster score for round 2 = 92000.6015625
[2m[36m(launch_and_fit pid=3048470)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=3048482)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=3048481)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=3048484)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=3048483)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=3048485)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=3048486)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=3048487)[0m Fitting Client 19
Performing server side distillation training...
[2m[36m(launch_and_fit pid=3048485)[0m malloc_consolidate(): invalid chunk size
E0714 14:06:57.831022173 3231515 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 120000ms
[2m[36m(launch_and_fit pid=3048486)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3048487)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3048484)[0m double free or corruption (fasttop)
Distillation training stopped at step number : 500
Average fusion training loss : 0.561910315990448, val accuracy : 0.4353156958648288, best val accuracy : 0.48465984882169855
Average local training loss : 7.762972760014236
Average local training accuracy : 0.8321952160493827
INFO flwr 2023-07-14 14:07:55,647 | server.py:116 | fit progress: (2, 2.323819058984103, {'server_test_acc': 0.3743732590529248}, 278.60473201196874)
INFO flwr 2023-07-14 14:07:55,648 | server.py:163 | evaluate_round 2: no clients selected, cancel
DEBUG flwr 2023-07-14 14:08:04,066 | server.py:215 | fit_round 3: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=3329734)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3329722)[0m double free or corruption (fasttop)
DEBUG flwr 2023-07-14 14:09:18,119 | server.py:229 | fit_round 3 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=3329761)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3329762)[0m double free or corruption (fasttop)
Cluster score for round 3 = 77167.3828125
[2m[36m(launch_and_fit pid=3329734)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=3329722)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=3329760)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=3329759)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=3329758)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=3329762)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=3329761)[0m Fitting Client 1
[2m[36m(launch_and_fit pid=3329763)[0m Fitting Client 0
Performing server side distillation training...
[2m[36m(launch_and_fit pid=3329760)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3329759)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3329758)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3329763)[0m corrupted size vs. prev_size in fastbins
Distillation training stopped at step number : 500
Average fusion training loss : 0.49715094113349917, val accuracy : 0.4258670520231214, best val accuracy : 0.4617607825700311
Average local training loss : 7.785052105784415
Average local training accuracy : 0.8287222222222222
INFO flwr 2023-07-14 14:10:18,847 | server.py:116 | fit progress: (3, 1.9015591586864757, {'server_test_acc': 0.3484679665738162}, 421.80433750298107)
INFO flwr 2023-07-14 14:10:18,847 | server.py:163 | evaluate_round 3: no clients selected, cancel
DEBUG flwr 2023-07-14 14:10:27,287 | server.py:215 | fit_round 4: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-07-14 14:11:44,461 | server.py:229 | fit_round 4 received 8 results and 0 failures
Cluster score for round 4 = 83554.9375
[2m[36m(launch_and_fit pid=3603279)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=3603424)[0m Fitting Client 11
[2m[36m(launch_and_fit pid=3603347)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=3603348)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=3603351)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=3603423)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=3603349)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=3603366)[0m Fitting Client 9
Performing server side distillation training...
[2m[36m(launch_and_fit pid=3603279)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3603348)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3603347)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3603349)[0m corrupted size vs. prev_size in fastbins
[2m[36m(launch_and_fit pid=3603366)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3603423)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3603424)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3603351)[0m malloc_consolidate(): invalid chunk size
E0714 14:12:17.950756489 3497194 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 240000ms
Distillation training stopped at step number : 500
Average fusion training loss : 0.3503153383135796, val accuracy : 0.4376278345931525, best val accuracy : 0.48099155180080033
Average local training loss : 7.836110584624112
Average local training accuracy : 0.8267245370370371
INFO flwr 2023-07-14 14:13:10,302 | server.py:116 | fit progress: (4, 2.409484379271611, {'server_test_acc': 0.3789693593314763}, 593.2593689659843)
INFO flwr 2023-07-14 14:13:10,302 | server.py:163 | evaluate_round 4: no clients selected, cancel
DEBUG flwr 2023-07-14 14:13:19,000 | server.py:215 | fit_round 5: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-07-14 14:14:33,325 | server.py:229 | fit_round 5 received 8 results and 0 failures
Cluster score for round 5 = 53562.15234375
[2m[36m(launch_and_fit pid=3893689)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=3893757)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=3893759)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=3893758)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=3893827)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=3893828)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=3893830)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=3893829)[0m Fitting Client 4
Warm start at round 5
Performing server side distillation training...
[2m[36m(launch_and_fit pid=3893830)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3893757)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3893828)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3893829)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3893689)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3893827)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3893759)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3893758)[0m malloc_consolidate(): invalid chunk size
E0714 14:14:36.225688463 4061400 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 480000ms
Distillation training stopped at step number : 500
Average fusion training loss : 0.4499745121002197, val accuracy : 0.39212983548243663, best val accuracy : 0.42807914628723875
Average local training loss : 7.85746184848249
Average local training accuracy : 0.8251064814814816
INFO flwr 2023-07-14 14:15:34,639 | server.py:116 | fit progress: (5, 3.233516872692905, {'server_test_acc': 0.31657381615598884}, 737.5959279759554)
INFO flwr 2023-07-14 14:15:34,639 | server.py:163 | evaluate_round 5: no clients selected, cancel
DEBUG flwr 2023-07-14 14:15:43,095 | server.py:215 | fit_round 6: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=4167897)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=4167980)[0m double free or corruption (fasttop)
DEBUG flwr 2023-07-14 14:16:56,692 | server.py:229 | fit_round 6 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=4168021)[0m malloc_consolidate(): invalid chunk size
Cluster score for round 6 = 41378.1171875
[2m[36m(launch_and_fit pid=4167897)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=4167980)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=4168021)[0m Fitting Client 9
[2m[36m(launch_and_fit pid=4168033)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=4168030)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=4168032)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=4167984)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=4168031)[0m Fitting Client 14
Performing server side distillation training...
[2m[36m(launch_and_fit pid=4168032)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=4168033)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=4168031)[0m malloc_consolidate(): invalid chunk size
E0714 14:16:57.817511292  128206 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 960000ms
[2m[36m(launch_and_fit pid=4168030)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=4167984)[0m double free or corruption (fasttop)
Distillation training stopped at step number : 500
Average fusion training loss : 0.32738539892435076, val accuracy : 0.43832814584259666, best val accuracy : 0.49610938194753224
Average local training loss : 7.150704410672188
Average local training accuracy : 0.877755401234568
INFO flwr 2023-07-14 14:17:55,543 | server.py:116 | fit progress: (6, 2.670611476101251, {'server_test_acc': 0.395125348189415}, 878.5001364569762)
INFO flwr 2023-07-14 14:17:55,543 | server.py:163 | evaluate_round 6: no clients selected, cancel
DEBUG flwr 2023-07-14 14:18:03,954 | server.py:215 | fit_round 7: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-07-14 14:19:17,723 | server.py:229 | fit_round 7 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=247497)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=247610)[0m double free or corruption (fasttop)
Cluster score for round 7 = 40714.62109375
[2m[36m(launch_and_fit pid=247497)[0m Fitting Client 11
[2m[36m(launch_and_fit pid=247495)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=247610)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=247715)[0m Fitting Client 0
[2m[36m(launch_and_fit pid=247645)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=247714)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=247644)[0m Fitting Client 4
[2m[36m(launch_and_fit pid=247713)[0m Fitting Client 1
Performing server side distillation training...
[2m[36m(launch_and_fit pid=247495)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=247713)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=247645)[0m malloc_consolidate(): invalid chunk size
E0714 14:19:19.006844700  391590 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 1920000ms
[2m[36m(launch_and_fit pid=247715)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=247714)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=247644)[0m double free or corruption (fasttop)
Distillation training stopped at step number : 500
Average fusion training loss : 0.40417415636777876, val accuracy : 0.4741774121831924, best val accuracy : 0.5221209426411738
Average local training loss : 7.249870894476771
Average local training accuracy : 0.8707260802469136
INFO flwr 2023-07-14 14:20:16,624 | server.py:116 | fit progress: (7, 3.332305179797839, {'server_test_acc': 0.3733983286908078}, 1019.5812840709696)
INFO flwr 2023-07-14 14:20:16,624 | server.py:163 | evaluate_round 7: no clients selected, cancel
DEBUG flwr 2023-07-14 14:20:25,087 | server.py:215 | fit_round 8: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-07-14 14:21:39,701 | server.py:229 | fit_round 8 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=520545)[0m malloc_consolidate(): invalid chunk size
Cluster score for round 8 = 56622.20703125
[2m[36m(launch_and_fit pid=520545)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=520629)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=520627)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=520698)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=520705)[0m Fitting Client 9
[2m[36m(launch_and_fit pid=520704)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=520475)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=520626)[0m Fitting Client 4
Performing server side distillation training...
[2m[36m(launch_and_fit pid=520698)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=520627)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=520626)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=520475)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=520705)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=520629)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=520704)[0m double free or corruption (fasttop)
E0714 14:21:42.763787573  656584 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 3840000ms
Distillation training stopped at step number : 500
Average fusion training loss : 0.3476760204434395, val accuracy : 0.43801689639839936, best val accuracy : 0.48143619386393954
Average local training loss : 7.234354267083109
Average local training accuracy : 0.8724691358024691
INFO flwr 2023-07-14 14:22:44,164 | server.py:116 | fit progress: (8, 2.9417375288301857, {'server_test_acc': 0.40626740947075207}, 1167.1216214499436)
INFO flwr 2023-07-14 14:22:44,165 | server.py:163 | evaluate_round 8: no clients selected, cancel
DEBUG flwr 2023-07-14 14:22:52,697 | server.py:215 | fit_round 9: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=797399)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-07-14 14:24:06,346 | server.py:229 | fit_round 9 received 8 results and 0 failures
Cluster score for round 9 = 54601.171875
[2m[36m(launch_and_fit pid=797252)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=797330)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=797328)[0m Fitting Client 0
[2m[36m(launch_and_fit pid=797398)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=797399)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=797401)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=797329)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=797400)[0m Fitting Client 17
Performing server side distillation training...
E0714 14:24:07.685659093  658807 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 7680000ms
[2m[36m(launch_and_fit pid=797330)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=797329)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=797398)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=797328)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=797401)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=797400)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=797252)[0m malloc_consolidate(): invalid chunk size
Distillation training stopped at step number : 500
Average fusion training loss : 0.4515638832449913, val accuracy : 0.4772120942641173, best val accuracy : 0.5380168963983993
Average local training loss : 7.384955710172653
Average local training accuracy : 0.8605432098765432
INFO flwr 2023-07-14 14:25:05,920 | server.py:116 | fit progress: (9, 3.350824684684987, {'server_test_acc': 0.556267409470752}, 1308.8769085939857)
INFO flwr 2023-07-14 14:25:05,920 | server.py:163 | evaluate_round 9: no clients selected, cancel
DEBUG flwr 2023-07-14 14:25:14,316 | server.py:215 | fit_round 10: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=1063912)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1064746)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-07-14 14:26:30,038 | server.py:229 | fit_round 10 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=1064351)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1064350)[0m malloc_consolidate(): invalid chunk size
Cluster score for round 10 = 58574.11328125
[2m[36m(launch_and_fit pid=1063912)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=1064351)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=1064350)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=1064746)[0m Fitting Client 0
[2m[36m(launch_and_fit pid=1064352)[0m Fitting Client 9
[2m[36m(launch_and_fit pid=1064353)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=1064354)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=1064747)[0m Fitting Client 7
Warm start at round 10
Performing server side distillation training...
[2m[36m(launch_and_fit pid=1064747)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1064354)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1064352)[0m double free or corruption (fasttop)
E0714 14:26:31.573750620  934828 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 15360000ms
[2m[36m(launch_and_fit pid=1064353)[0m double free or corruption (fasttop)
Distillation training stopped at step number : 500
Average fusion training loss : 0.4606139230132103, val accuracy : 0.42819030680302356, best val accuracy : 0.45153401511783015
Average local training loss : 7.396643375046552
Average local training accuracy : 0.8594251543209878
INFO flwr 2023-07-14 14:27:30,031 | server.py:116 | fit progress: (10, 5.035281104297691, {'server_test_acc': 0.2649025069637883}, 1452.9884184279945)
INFO flwr 2023-07-14 14:27:30,031 | server.py:163 | evaluate_round 10: no clients selected, cancel
DEBUG flwr 2023-07-14 14:27:38,615 | server.py:215 | fit_round 11: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=1327593)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1327754)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1327619)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1327597)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-07-14 14:28:53,426 | server.py:229 | fit_round 11 received 8 results and 0 failures
Cluster score for round 11 = 37547.84765625
[2m[36m(launch_and_fit pid=1327593)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=1327754)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=1327619)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=1327758)[0m Fitting Client 4
[2m[36m(launch_and_fit pid=1327755)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=1327597)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=1327602)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=1327757)[0m Fitting Client 10
Performing server side distillation training...
[2m[36m(launch_and_fit pid=1327755)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1327758)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1327602)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1327757)[0m malloc_consolidate(): invalid chunk size
E0714 14:28:55.613837064 1491642 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 30720000ms
Distillation training stopped at step number : 500
Average fusion training loss : 0.5479148867130279, val accuracy : 0.4574588706091597, best val accuracy : 0.48766118274788794
Average local training loss : 6.938723306730389
Average local training accuracy : 0.8941574074074075
INFO flwr 2023-07-14 14:29:51,890 | server.py:116 | fit progress: (11, 3.9236094254305103, {'server_test_acc': 0.3467966573816156}, 1594.8473184879986)
INFO flwr 2023-07-14 14:29:51,890 | server.py:163 | evaluate_round 11: no clients selected, cancel
DEBUG flwr 2023-07-14 14:30:00,401 | server.py:215 | fit_round 12: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=1590850)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1590838)[0m corrupted size vs. prev_size in fastbins
[2m[36m(launch_and_fit pid=1590874)[0m corrupted size vs. prev_size in fastbins
DEBUG flwr 2023-07-14 14:31:15,149 | server.py:229 | fit_round 12 received 8 results and 0 failures
Cluster score for round 12 = 42790.28515625
[2m[36m(launch_and_fit pid=1590851)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=1590850)[0m Fitting Client 11
[2m[36m(launch_and_fit pid=1590874)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=1590839)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=1590838)[0m Fitting Client 4
[2m[36m(launch_and_fit pid=1590835)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=1591219)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=1591218)[0m Fitting Client 12
Performing server side distillation training...
[2m[36m(launch_and_fit pid=1590851)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1590839)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1591218)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1591219)[0m corrupted size vs. prev_size in fastbins
[2m[36m(launch_and_fit pid=1590835)[0m double free or corruption (fasttop)
Distillation training stopped at step number : 500
Average fusion training loss : 0.4594498744606972, val accuracy : 0.4606825255669186, best val accuracy : 0.4796576256113828
Average local training loss : 6.862404842302203
Average local training accuracy : 0.8991728395061729
INFO flwr 2023-07-14 14:32:13,124 | server.py:116 | fit progress: (12, 3.828640450607767, {'server_test_acc': 0.2894150417827298}, 1736.0814933709917)
INFO flwr 2023-07-14 14:32:13,124 | server.py:163 | evaluate_round 12: no clients selected, cancel
DEBUG flwr 2023-07-14 14:32:21,685 | server.py:215 | fit_round 13: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=1853718)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1853570)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1853642)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-07-14 14:33:36,183 | server.py:229 | fit_round 13 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=1853719)[0m malloc_consolidate(): invalid chunk size
Cluster score for round 13 = 44016.87109375
[2m[36m(launch_and_fit pid=1853570)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=1853642)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=1853718)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=1853433)[0m Fitting Client 0
[2m[36m(launch_and_fit pid=1853706)[0m Fitting Client 19
[2m[36m(launch_and_fit pid=1853719)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=1853608)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=1853717)[0m Fitting Client 12
Performing server side distillation training...
[2m[36m(launch_and_fit pid=1853433)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1853608)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1853706)[0m malloc_consolidate(): invalid chunk size
E0714 14:33:37.750544496 1549218 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 61440000ms
E0714 14:33:37.750592207 1549218 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 61440000ms
E0714 14:33:37.750599665 1549218 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 61440000ms
E0714 14:33:37.750606478 1549218 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 61440000ms
E0714 14:33:37.750612751 1549218 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 61440000ms
[2m[36m(launch_and_fit pid=1853717)[0m malloc_consolidate(): invalid chunk size
Distillation training stopped at step number : 500
Average fusion training loss : 0.3381363634467125, val accuracy : 0.39378612716763006, best val accuracy : 0.4340818141396176
Average local training loss : 6.904076395556331
Average local training accuracy : 0.8951350308641974
INFO flwr 2023-07-14 14:34:34,336 | server.py:116 | fit progress: (13, 4.212437849124494, {'server_test_acc': 0.3501392757660167}, 1877.2932064109482)
INFO flwr 2023-07-14 14:34:34,336 | server.py:163 | evaluate_round 13: no clients selected, cancel
DEBUG flwr 2023-07-14 14:34:42,765 | server.py:215 | fit_round 14: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=2119534)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2119547)[0m double free or corruption (fasttop)
DEBUG flwr 2023-07-14 14:35:57,121 | server.py:229 | fit_round 14 received 8 results and 0 failures
Cluster score for round 14 = 61846.6171875
[2m[36m(launch_and_fit pid=2119534)[0m Fitting Client 9
[2m[36m(launch_and_fit pid=2119543)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=2119546)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=2119547)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=2119679)[0m Fitting Client 11
[2m[36m(launch_and_fit pid=2119680)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=2119545)[0m Fitting Client 1
[2m[36m(launch_and_fit pid=2119548)[0m Fitting Client 2
Performing server side distillation training...
[2m[36m(launch_and_fit pid=2119543)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2119546)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2119680)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2119545)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2119548)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2119679)[0m double free or corruption (fasttop)
E0714 14:35:59.506501235 2309956 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 122880000ms
Distillation training stopped at step number : 500
Average fusion training loss : 0.3437863956093788, val accuracy : 0.540073365940418, best val accuracy : 0.5973766118274789
Average local training loss : 7.008932257816195
Average local training accuracy : 0.888358024691358
INFO flwr 2023-07-14 14:36:57,481 | server.py:116 | fit progress: (14, 3.1671056200202794, {'server_test_acc': 0.5522284122562674}, 2020.4386346969986)
INFO flwr 2023-07-14 14:36:57,482 | server.py:163 | evaluate_round 14: no clients selected, cancel
DEBUG flwr 2023-07-14 14:37:05,968 | server.py:215 | fit_round 15: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=2402007)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-07-14 14:38:21,679 | server.py:229 | fit_round 15 received 8 results and 0 failures
Cluster score for round 15 = 75676.3046875
[2m[36m(launch_and_fit pid=2402007)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=2402011)[0m Fitting Client 4
[2m[36m(launch_and_fit pid=2402009)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=2402021)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=2402024)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=2402025)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=2402022)[0m Fitting Client 19
[2m[36m(launch_and_fit pid=2402023)[0m Fitting Client 8
Warm start at round 15
Performing server side distillation training...
[2m[36m(launch_and_fit pid=2402011)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2402025)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2402023)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2402009)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2402021)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2402024)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2402022)[0m double free or corruption (fasttop)
E0714 14:38:24.102043009 2583007 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 245760000ms
Distillation training stopped at step number : 500
Average fusion training loss : 0.4326451066732407, val accuracy : 0.48518230324588707, best val accuracy : 0.5367941307247666
Average local training loss : 7.016793781146407
Average local training accuracy : 0.8885254629629629
INFO flwr 2023-07-14 14:39:20,212 | server.py:116 | fit progress: (15, 6.642251434432431, {'server_test_acc': 0.43997214484679664}, 2163.168992049992)
INFO flwr 2023-07-14 14:39:20,212 | server.py:163 | evaluate_round 15: no clients selected, cancel
DEBUG flwr 2023-07-14 14:39:28,669 | server.py:215 | fit_round 16: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=2679709)[0m double free or corruption (fasttop)
DEBUG flwr 2023-07-14 14:40:42,250 | server.py:229 | fit_round 16 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=2679795)[0m malloc_consolidate(): invalid chunk size
Cluster score for round 16 = 30812.34765625
[2m[36m(launch_and_fit pid=2679699)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=2679709)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=2679710)[0m Fitting Client 9
[2m[36m(launch_and_fit pid=2679698)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=2679696)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=2679782)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=2679795)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=2679783)[0m Fitting Client 19
Performing server side distillation training...
[2m[36m(launch_and_fit pid=2679696)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2679698)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2679783)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2679699)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2679782)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2679710)[0m double free or corruption (fasttop)
E0714 14:40:47.141228460 2583282 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 491520000ms
E0714 14:41:05.264601258 2889853 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 983040000ms
Distillation training stopped at step number : 500
Average fusion training loss : 0.30958603239059446, val accuracy : 0.5533459315251223, best val accuracy : 0.6427301022676746
Average local training loss : 6.511912424117327
Average local training accuracy : 0.9240740740740742
INFO flwr 2023-07-14 14:41:42,173 | server.py:116 | fit progress: (16, 4.81396742637443, {'server_test_acc': 0.48161559888579386}, 2305.1305182459764)
INFO flwr 2023-07-14 14:41:42,173 | server.py:163 | evaluate_round 16: no clients selected, cancel
DEBUG flwr 2023-07-14 14:41:50,765 | server.py:215 | fit_round 17: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=2954967)[0m ERROR: Unexpected segmentation fault encountered in worker.
[2m[36m(launch_and_fit pid=2954967)[0m  
[2m[36m(launch_and_fit pid=2955044)[0m ERROR: Unexpected segmentation fault encountered in worker.
[2m[36m(launch_and_fit pid=2955044)[0m  
[2m[36m(launch_and_fit pid=2955046)[0m ERROR: Unexpected segmentation fault encountered in worker.
[2m[36m(launch_and_fit pid=2955046)[0m  
[2m[36m(launch_and_fit pid=2955048)[0m ERROR: Unexpected segmentation fault encountered in worker.
[2m[36m(launch_and_fit pid=2955048)[0m  
DEBUG flwr 2023-07-14 14:44:03,614 | ray_client_proxy.py:87 | [36mray::launch_and_fit()[39m (pid=2954967, ip=145.136.62.16)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 148, in launch_and_fit
    return maybe_call_fit(
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/flwr/client/client.py", line 184, in maybe_call_fit
    return client.fit(fit_ins)
  File "/gpfs/home1/sunnys/thesis_23/single_image_fl/client/fed_df.py", line 118, in fit
    new_parameters, distill_preds, train_res = train_model(
  File "/gpfs/home1/sunnys/thesis_23/single_image_fl/client/fed_df.py", line 54, in train_model
    epoch_loss += loss.item()
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 3076941) is killed by signal: Segmentation fault.
DEBUG flwr 2023-07-14 14:44:03,655 | ray_client_proxy.py:87 | [36mray::launch_and_fit()[39m (pid=2955048, ip=145.136.62.16)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 148, in launch_and_fit
    return maybe_call_fit(
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/flwr/client/client.py", line 184, in maybe_call_fit
    return client.fit(fit_ins)
  File "/gpfs/home1/sunnys/thesis_23/single_image_fl/client/fed_df.py", line 118, in fit
    new_parameters, distill_preds, train_res = train_model(
  File "/gpfs/home1/sunnys/thesis_23/single_image_fl/client/fed_df.py", line 57, in train_model
    [1] == labels).sum().item()
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 3077074) is killed by signal: Segmentation fault.
DEBUG flwr 2023-07-14 14:44:03,659 | ray_client_proxy.py:87 | [36mray::launch_and_fit()[39m (pid=2955046, ip=145.136.62.16)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/multiprocessing/queues.py", line 113, in get
    if not self._poll(timeout):
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/multiprocessing/connection.py", line 424, in _poll
    r = wait([self], timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 3074046) is killed by signal: Segmentation fault. 

The above exception was the direct cause of the following exception:

[36mray::launch_and_fit()[39m (pid=2955046, ip=145.136.62.16)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 148, in launch_and_fit
    return maybe_call_fit(
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/flwr/client/client.py", line 184, in maybe_call_fit
    return client.fit(fit_ins)
  File "/gpfs/home1/sunnys/thesis_23/single_image_fl/client/fed_df.py", line 118, in fit
    new_parameters, distill_preds, train_res = train_model(
  File "/gpfs/home1/sunnys/thesis_23/single_image_fl/client/fed_df.py", line 45, in train_model
    for images, labels in train_loader:
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1316, in _next_data
    idx, data = self._get_data()
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1282, in _get_data
    success, data = self._try_get_data()
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1133, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 3074046) exited unexpectedly
DEBUG flwr 2023-07-14 14:44:03,660 | ray_client_proxy.py:87 | [36mray::launch_and_fit()[39m (pid=2955044, ip=145.136.62.16)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/multiprocessing/queues.py", line 113, in get
    if not self._poll(timeout):
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/multiprocessing/connection.py", line 424, in _poll
    r = wait([self], timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 3074174) is killed by signal: Segmentation fault. 

The above exception was the direct cause of the following exception:

[36mray::launch_and_fit()[39m (pid=2955044, ip=145.136.62.16)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 148, in launch_and_fit
    return maybe_call_fit(
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/flwr/client/client.py", line 184, in maybe_call_fit
    return client.fit(fit_ins)
  File "/gpfs/home1/sunnys/thesis_23/single_image_fl/client/fed_df.py", line 118, in fit
    new_parameters, distill_preds, train_res = train_model(
  File "/gpfs/home1/sunnys/thesis_23/single_image_fl/client/fed_df.py", line 45, in train_model
    for images, labels in train_loader:
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1316, in _next_data
    idx, data = self._get_data()
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1282, in _get_data
    success, data = self._try_get_data()
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1133, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 3074174) exited unexpectedly
[2m[36m(launch_and_fit pid=2955048)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2955044)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2955046)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2954967)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2954968)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-07-14 14:44:09,560 | server.py:229 | fit_round 17 received 4 results and 4 failures
Cluster score for round 17 = 41820.6796875
[2m[36m(launch_and_fit pid=2954967)[0m Fitting Client 11
[2m[36m(launch_and_fit pid=2954968)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=2955048)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=2955046)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=2955045)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=2955047)[0m Fitting Client 1
[2m[36m(launch_and_fit pid=2954966)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=2955044)[0m Fitting Client 15
Performing server side distillation training...
[2m[36m(launch_and_fit pid=2955045)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2954966)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2955047)[0m malloc_consolidate(): invalid chunk size
E0714 14:44:11.977142302 3162311 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 1966080000ms
Distillation training stopped at step number : 500
Average fusion training loss : 0.5764266985654831, val accuracy : 0.5572587816807469, best val accuracy : 0.6140506891951979
Average local training loss : 6.512334125116468
Average local training accuracy : 0.9245354938271605
INFO flwr 2023-07-14 14:45:07,535 | server.py:116 | fit progress: (17, 3.862533483797461, {'server_test_acc': 0.5906685236768803}, 2510.49255991698)
INFO flwr 2023-07-14 14:45:07,535 | server.py:163 | evaluate_round 17: no clients selected, cancel
DEBUG flwr 2023-07-14 14:45:16,065 | server.py:215 | fit_round 18: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=3261542)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3261835)[0m double free or corruption (fasttop)
DEBUG flwr 2023-07-14 14:46:31,132 | server.py:229 | fit_round 18 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=3261836)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3261559)[0m corrupted size vs. prev_size in fastbins
Cluster score for round 18 = 31612.15234375
[2m[36m(launch_and_fit pid=3261561)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=3261542)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=3261541)[0m Fitting Client 0
[2m[36m(launch_and_fit pid=3261562)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=3261701)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=3261836)[0m Fitting Client 11
[2m[36m(launch_and_fit pid=3261559)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=3261835)[0m Fitting Client 1
Performing server side distillation training...
E0714 14:46:31.766655816 3444919 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
[2m[36m(launch_and_fit pid=3261541)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3261562)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3261561)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3261701)[0m double free or corruption (fasttop)
Distillation training stopped at step number : 500
Average fusion training loss : 0.4261931034326553, val accuracy : 0.5357714539795465, best val accuracy : 0.5801467318808359
Average local training loss : 6.5770470621064305
Average local training accuracy : 0.919514660493827
INFO flwr 2023-07-14 14:47:32,685 | server.py:116 | fit progress: (18, 3.895011032125744, {'server_test_acc': 0.5284122562674095}, 2655.6421999149607)
INFO flwr 2023-07-14 14:47:32,685 | server.py:163 | evaluate_round 18: no clients selected, cancel
DEBUG flwr 2023-07-14 14:47:41,296 | server.py:215 | fit_round 19: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-07-14 14:48:55,932 | server.py:229 | fit_round 19 received 8 results and 0 failures
Cluster score for round 19 = 29761.60546875
[2m[36m(launch_and_fit pid=3532715)[0m Fitting Client 1
[2m[36m(launch_and_fit pid=3532713)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=3532712)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=3532716)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=3532718)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=3532719)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=3532728)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=3532717)[0m Fitting Client 19
Performing server side distillation training...
[2m[36m(launch_and_fit pid=3532715)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3532713)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3532716)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3532719)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3532712)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3532728)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3532717)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3532718)[0m malloc_consolidate(): invalid chunk size
E0714 14:48:58.538493045 3445471 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
Distillation training stopped at step number : 500
Average fusion training loss : 0.4669579435586929, val accuracy : 0.5839706536238327, best val accuracy : 0.6208314806580703
Average local training loss : 6.513032206334174
Average local training accuracy : 0.9241018518518519
INFO flwr 2023-07-14 14:49:56,644 | server.py:116 | fit progress: (19, 5.250147163369862, {'server_test_acc': 0.4541782729805014}, 2799.601290606952)
INFO flwr 2023-07-14 14:49:56,644 | server.py:163 | evaluate_round 19: no clients selected, cancel
DEBUG flwr 2023-07-14 14:50:05,215 | server.py:215 | fit_round 20: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=3815184)[0m double free or corruption (fasttop)
DEBUG flwr 2023-07-14 14:51:21,266 | server.py:229 | fit_round 20 received 8 results and 0 failures
Cluster score for round 20 = 35180.53125
[2m[36m(launch_and_fit pid=3815184)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=3815186)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=3815183)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=3815197)[0m Fitting Client 4
[2m[36m(launch_and_fit pid=3815209)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=3815207)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=3815206)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=3815208)[0m Fitting Client 3
Warm start at round 20
Performing server side distillation training...
[2m[36m(launch_and_fit pid=3815208)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3815207)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3815186)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3815183)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3815206)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3815197)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3815209)[0m malloc_consolidate(): invalid chunk size
E0714 14:51:23.627115233 3724683 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
E0714 14:51:46.955651660 4033213 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
E0714 14:52:11.871477140 4034129 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
Distillation training stopped at step number : 500
Average fusion training loss : 0.4907705118060112, val accuracy : 0.5213205869275234, best val accuracy : 0.602712316585149
Average local training loss : 6.626929950714111
Average local training accuracy : 0.9165756172839505
INFO flwr 2023-07-14 14:52:22,196 | server.py:116 | fit progress: (20, 5.5919084782719946, {'server_test_acc': 0.5713091922005571}, 2945.1538088679663)
INFO flwr 2023-07-14 14:52:22,197 | server.py:163 | evaluate_round 20: no clients selected, cancel
DEBUG flwr 2023-07-14 14:52:30,768 | server.py:215 | fit_round 21: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=4095387)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=4095466)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=4095319)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=4095599)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=4095589)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=4095598)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-07-14 14:53:47,172 | server.py:229 | fit_round 21 received 8 results and 0 failures
Cluster score for round 21 = 31376.84375
[2m[36m(launch_and_fit pid=4095387)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=4095319)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=4095466)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=4095589)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=4095598)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=4095599)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=4095465)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=4095588)[0m Fitting Client 19
Performing server side distillation training...
E0714 14:53:48.244831070 4072360 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
[2m[36m(launch_and_fit pid=4095465)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=4095588)[0m double free or corruption (fasttop)
Distillation training stopped at step number : 500
Average fusion training loss : 0.4729739860296249, val accuracy : 0.5420075589150734, best val accuracy : 0.6037127612272121
Average local training loss : 6.234296422824264
Average local training accuracy : 0.9439382716049383
INFO flwr 2023-07-14 14:54:47,293 | server.py:116 | fit progress: (21, 6.401927442736612, {'server_test_acc': 0.5112813370473538}, 3090.2506407409674)
INFO flwr 2023-07-14 14:54:47,294 | server.py:163 | evaluate_round 21: no clients selected, cancel
DEBUG flwr 2023-07-14 14:54:55,759 | server.py:215 | fit_round 22: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=176664)[0m double free or corruption (fasttop)
DEBUG flwr 2023-07-14 14:56:09,931 | server.py:229 | fit_round 22 received 8 results and 0 failures
Cluster score for round 22 = 33837.48828125
[2m[36m(launch_and_fit pid=176584)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=176596)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=176666)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=176595)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=176664)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=176586)[0m Fitting Client 1
[2m[36m(launch_and_fit pid=176667)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=176665)[0m Fitting Client 11
Performing server side distillation training...
[2m[36m(launch_and_fit pid=176667)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=176596)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=176595)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=176665)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=176584)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=176586)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=176666)[0m corrupted size vs. prev_size in fastbins
E0714 14:56:14.379523723  336710 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
Distillation training stopped at step number : 500
Average fusion training loss : 0.6041989331245422, val accuracy : 0.5336927523343709, best val accuracy : 0.5799244108492664
Average local training loss : 6.284729402884841
Average local training accuracy : 0.9405177469135804
INFO flwr 2023-07-14 14:57:10,919 | server.py:116 | fit progress: (22, 6.366691026182892, {'server_test_acc': 0.40682451253481894}, 3233.8767955609947)
INFO flwr 2023-07-14 14:57:10,920 | server.py:163 | evaluate_round 22: no clients selected, cancel
DEBUG flwr 2023-07-14 14:57:19,369 | server.py:215 | fit_round 23: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-07-14 14:58:39,046 | server.py:229 | fit_round 23 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=451597)[0m double free or corruption (fasttop)
Cluster score for round 23 = 39334.9296875
[2m[36m(launch_and_fit pid=451598)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=451666)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=451450)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=451597)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=451372)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=451596)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=451667)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=451457)[0m Fitting Client 6
Performing server side distillation training...
[2m[36m(launch_and_fit pid=451450)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=451598)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=451667)[0m corrupted size vs. prev_size in fastbins
E0714 14:58:40.022283445  604808 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
[2m[36m(launch_and_fit pid=451457)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=451666)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=451596)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=451372)[0m double free or corruption (fasttop)
Distillation training stopped at step number : 500
Average fusion training loss : 0.5182225338816643, val accuracy : 0.6136171631836371, best val accuracy : 0.6617385504668741
Average local training loss : 6.379408398270607
Average local training accuracy : 0.9340370370370369
INFO flwr 2023-07-14 14:59:38,621 | server.py:116 | fit progress: (23, 4.20398086399089, {'server_test_acc': 0.5987465181058496}, 3381.5787236909964)
INFO flwr 2023-07-14 14:59:38,622 | server.py:163 | evaluate_round 23: no clients selected, cancel
DEBUG flwr 2023-07-14 14:59:47,102 | server.py:215 | fit_round 24: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=728147)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-07-14 15:01:01,893 | server.py:229 | fit_round 24 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=728148)[0m malloc_consolidate(): invalid chunk size
Cluster score for round 24 = 37378.9296875
[2m[36m(launch_and_fit pid=728145)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=728146)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=728076)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=728148)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=728225)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=728147)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=728224)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=728260)[0m Fitting Client 19
Performing server side distillation training...
E0714 15:01:02.681080658  865156 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
[2m[36m(launch_and_fit pid=728145)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=728225)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=728076)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=728224)[0m double free or corruption (fasttop)
E0714 15:01:03.122448665  866625 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
[2m[36m(launch_and_fit pid=728260)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=728146)[0m double free or corruption (fasttop)
Distillation training stopped at step number : 500
Average fusion training loss : 0.5134405606985092, val accuracy : 0.4261338372610049, best val accuracy : 0.4588706091596265
Average local training loss : 6.256416042521596
Average local training accuracy : 0.9429251543209877
INFO flwr 2023-07-14 15:02:02,059 | server.py:116 | fit progress: (24, 10.927499546911724, {'server_test_acc': 0.31462395543175486}, 3525.016735544952)
INFO flwr 2023-07-14 15:02:02,060 | server.py:163 | evaluate_round 24: no clients selected, cancel
DEBUG flwr 2023-07-14 15:02:10,550 | server.py:215 | fit_round 25: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=1002293)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1002292)[0m double free or corruption (fasttop)
DEBUG flwr 2023-07-14 15:03:24,729 | server.py:229 | fit_round 25 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=1002437)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1002439)[0m double free or corruption (fasttop)
Cluster score for round 25 = 48961.34375
[2m[36m(launch_and_fit pid=1002293)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=1002437)[0m Fitting Client 0
[2m[36m(launch_and_fit pid=1002439)[0m Fitting Client 19
[2m[36m(launch_and_fit pid=1002438)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=1002441)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=1002292)[0m Fitting Client 1
[2m[36m(launch_and_fit pid=1002369)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=1002440)[0m Fitting Client 14
Warm start at round 25
Performing server side distillation training...
[2m[36m(launch_and_fit pid=1002438)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1002441)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1002369)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1002440)[0m double free or corruption (fasttop)
E0714 15:03:27.532906388 1137278 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
Distillation training stopped at step number : 500
Average fusion training loss : 0.6792680497169494, val accuracy : 0.3555246776345042, best val accuracy : 0.4096265006669631
Average local training loss : 6.367909886501729
Average local training accuracy : 0.9345933641975308
INFO flwr 2023-07-14 15:04:25,184 | server.py:116 | fit progress: (25, 7.86858787961657, {'server_test_acc': 0.29596100278551535}, 3668.140910612943)
INFO flwr 2023-07-14 15:04:25,184 | server.py:163 | evaluate_round 25: no clients selected, cancel
DEBUG flwr 2023-07-14 15:04:33,780 | server.py:215 | fit_round 26: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=1273081)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1273249)[0m double free or corruption (fasttop)
DEBUG flwr 2023-07-14 15:05:48,630 | server.py:229 | fit_round 26 received 8 results and 0 failures
Cluster score for round 26 = 25659.49609375
[2m[36m(launch_and_fit pid=1273217)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=1273081)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=1273216)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=1273082)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=1273251)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=1273250)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=1273249)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=1273364)[0m Fitting Client 0
Performing server side distillation training...
[2m[36m(launch_and_fit pid=1273364)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1273217)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1273082)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1273251)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1273250)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1273216)[0m double free or corruption (fasttop)
E0714 15:05:52.909971035 1419786 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
Distillation training stopped at step number : 500
Average fusion training loss : 0.40602375453710554, val accuracy : 0.6463094708759448, best val accuracy : 0.6987550022232103
Average local training loss : 6.151557530462743
Average local training accuracy : 0.9500223765432099
INFO flwr 2023-07-14 15:06:49,283 | server.py:116 | fit progress: (26, 2.6456105173796334, {'server_test_acc': 0.6938718662952646}, 3812.240140967944)
INFO flwr 2023-07-14 15:06:49,283 | server.py:163 | evaluate_round 26: no clients selected, cancel
DEBUG flwr 2023-07-14 15:06:57,718 | server.py:215 | fit_round 27: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-07-14 15:08:11,576 | server.py:229 | fit_round 27 received 8 results and 0 failures
Cluster score for round 27 = 26392.494140625
[2m[36m(launch_and_fit pid=1538829)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=1538965)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=1539118)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=1539120)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=1539132)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=1539119)[0m Fitting Client 0
[2m[36m(launch_and_fit pid=1539131)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=1539133)[0m Fitting Client 16
Performing server side distillation training...
[2m[36m(launch_and_fit pid=1539118)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1539120)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1539133)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1539119)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1538829)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1538965)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1539131)[0m malloc_consolidate(): invalid chunk size
E0714 15:08:13.829334256 1695975 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
E0714 15:08:44.842761792 1731323 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
Distillation training stopped at step number : 500
Average fusion training loss : 0.4018845270872116, val accuracy : 0.5205313472654514, best val accuracy : 0.5626945309026233
Average local training loss : 6.089206647872924
Average local training accuracy : 0.9550871913580246
INFO flwr 2023-07-14 15:09:11,906 | server.py:116 | fit progress: (27, 4.744992109261515, {'server_test_acc': 0.567966573816156}, 3954.8630375349894)
INFO flwr 2023-07-14 15:09:11,906 | server.py:163 | evaluate_round 27: no clients selected, cancel
DEBUG flwr 2023-07-14 15:09:20,517 | server.py:215 | fit_round 28: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=1801895)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1801890)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1802138)[0m double free or corruption (fasttop)
DEBUG flwr 2023-07-14 15:10:34,872 | server.py:229 | fit_round 28 received 8 results and 0 failures
Cluster score for round 28 = 28600.890625
[2m[36m(launch_and_fit pid=1801895)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=1801890)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=1802175)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=1802138)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=1802187)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=1802174)[0m Fitting Client 4
[2m[36m(launch_and_fit pid=1802186)[0m Fitting Client 19
[2m[36m(launch_and_fit pid=1801893)[0m Fitting Client 9
Performing server side distillation training...
E0714 15:10:35.445961217 1732927 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
[2m[36m(launch_and_fit pid=1802187)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1802174)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1802186)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1801893)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1802175)[0m malloc_consolidate(): invalid chunk size
Distillation training stopped at step number : 500
Average fusion training loss : 0.6089798876047134, val accuracy : 0.4351156069364162, best val accuracy : 0.4689862160960427
Average local training loss : 6.152701215073466
Average local training accuracy : 0.9502530864197531
INFO flwr 2023-07-14 15:11:35,027 | server.py:116 | fit progress: (28, 4.783472842426353, {'server_test_acc': 0.3838440111420613}, 4097.98413228197)
INFO flwr 2023-07-14 15:11:35,027 | server.py:163 | evaluate_round 28: no clients selected, cancel
DEBUG flwr 2023-07-14 15:11:43,756 | server.py:215 | fit_round 29: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=2057437)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2057962)[0m double free or corruption (fasttop)
DEBUG flwr 2023-07-14 15:12:57,599 | server.py:229 | fit_round 29 received 8 results and 0 failures
Cluster score for round 29 = 33838.47265625
[2m[36m(launch_and_fit pid=2057437)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=2057818)[0m Fitting Client 1
[2m[36m(launch_and_fit pid=2057820)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=2057822)[0m Fitting Client 19
[2m[36m(launch_and_fit pid=2057964)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=2057962)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=2057981)[0m Fitting Client 9
[2m[36m(launch_and_fit pid=2057966)[0m Fitting Client 0
Performing server side distillation training...
[2m[36m(launch_and_fit pid=2057818)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2057981)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2057820)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2057966)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2057822)[0m corrupted size vs. prev_size in fastbins
[2m[36m(launch_and_fit pid=2057964)[0m malloc_consolidate(): invalid chunk size
E0714 15:13:00.489835575 1964222 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
Distillation training stopped at step number : 500
Average fusion training loss : 0.5612908862829208, val accuracy : 0.5384170742552246, best val accuracy : 0.588150289017341
Average local training loss : 6.189307311363518
Average local training accuracy : 0.9469822530864198
INFO flwr 2023-07-14 15:13:56,196 | server.py:116 | fit progress: (29, 10.058969727731348, {'server_test_acc': 0.5076601671309192}, 4239.153042515973)
INFO flwr 2023-07-14 15:13:56,196 | server.py:163 | evaluate_round 29: no clients selected, cancel
DEBUG flwr 2023-07-14 15:14:05,506 | server.py:215 | fit_round 30: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=2321447)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2321446)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2321448)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-07-14 15:15:21,416 | server.py:229 | fit_round 30 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=2321434)[0m double free or corruption (fasttop)
Cluster score for round 30 = 43661.53515625
[2m[36m(launch_and_fit pid=2321434)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=2321446)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=2321447)[0m Fitting Client 1
[2m[36m(launch_and_fit pid=2321448)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=2321445)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=2321457)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=2321459)[0m Fitting Client 19
[2m[36m(launch_and_fit pid=2321458)[0m Fitting Client 2
Warm start at round 30
Performing server side distillation training...
[2m[36m(launch_and_fit pid=2321445)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2321459)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2321458)[0m double free or corruption (fasttop)
E0714 15:15:22.587999421 2240285 chttp2_transport.cc:1079]             ipv4:145.136.62.16:56763: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): ∞
[2m[36m(launch_and_fit pid=2321457)[0m double free or corruption (fasttop)
Distillation training stopped at step number : 500
Average fusion training loss : 0.550705669760704, val accuracy : 0.5626611827478879, best val accuracy : 0.6401734104046243
Average local training loss : 6.184487626701593
Average local training accuracy : 0.9478155864197532
INFO flwr 2023-07-14 15:16:20,165 | server.py:116 | fit progress: (30, 4.93417824503439, {'server_test_acc': 0.5944289693593314}, 4383.122567358951)
INFO flwr 2023-07-14 15:16:20,165 | server.py:163 | evaluate_round 30: no clients selected, cancel
INFO flwr 2023-07-14 15:16:20,166 | server.py:144 | FL finished in 4383.12290882197
INFO flwr 2023-07-14 15:16:20,166 | app.py:202 | app_fit: losses_distributed []
INFO flwr 2023-07-14 15:16:20,167 | app.py:203 | app_fit: metrics_distributed {}
INFO flwr 2023-07-14 15:16:20,167 | app.py:204 | app_fit: losses_centralized [(0, 2.1845225108367154), (1, 1.9129554785725797), (2, 2.323819058984103), (3, 1.9015591586864757), (4, 2.409484379271611), (5, 3.233516872692905), (6, 2.670611476101251), (7, 3.332305179797839), (8, 2.9417375288301857), (9, 3.350824684684987), (10, 5.035281104297691), (11, 3.9236094254305103), (12, 3.828640450607767), (13, 4.212437849124494), (14, 3.1671056200202794), (15, 6.642251434432431), (16, 4.81396742637443), (17, 3.862533483797461), (18, 3.895011032125744), (19, 5.250147163369862), (20, 5.5919084782719946), (21, 6.401927442736612), (22, 6.366691026182892), (23, 4.20398086399089), (24, 10.927499546911724), (25, 7.86858787961657), (26, 2.6456105173796334), (27, 4.744992109261515), (28, 4.783472842426353), (29, 10.058969727731348), (30, 4.93417824503439)]
INFO flwr 2023-07-14 15:16:20,167 | app.py:205 | app_fit: metrics_centralized {'server_test_acc': [(0, 0.11030640668523677), (1, 0.34428969359331474), (2, 0.3743732590529248), (3, 0.3484679665738162), (4, 0.3789693593314763), (5, 0.31657381615598884), (6, 0.395125348189415), (7, 0.3733983286908078), (8, 0.40626740947075207), (9, 0.556267409470752), (10, 0.2649025069637883), (11, 0.3467966573816156), (12, 0.2894150417827298), (13, 0.3501392757660167), (14, 0.5522284122562674), (15, 0.43997214484679664), (16, 0.48161559888579386), (17, 0.5906685236768803), (18, 0.5284122562674095), (19, 0.4541782729805014), (20, 0.5713091922005571), (21, 0.5112813370473538), (22, 0.40682451253481894), (23, 0.5987465181058496), (24, 0.31462395543175486), (25, 0.29596100278551535), (26, 0.6938718662952646), (27, 0.567966573816156), (28, 0.3838440111420613), (29, 0.5076601671309192), (30, 0.5944289693593314)]}
double free or corruption (fasttop)
srun: error: gcn16: task 0: Aborted
srun: launch/slurm: _step_signal: Terminating StepId=3066752.1
-----EXPERIMENT ENDS-----
-----END-----

JOB STATISTICS
==============
Job ID: 3066752
Cluster: snellius
User/Group: sunnys/sunnys
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 18
CPU Utilized: 02:41:28
CPU Efficiency: 11.89% of 22:37:48 core-walltime
Job Wall-clock time: 01:15:26
Memory Utilized: 63.80 GB
Memory Efficiency: 53.17% of 120.00 GB
