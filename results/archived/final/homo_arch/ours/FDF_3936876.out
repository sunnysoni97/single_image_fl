-----BEGIN-----
-----SETTINGS-----
TOTAL CROPS:50000
STRATEGY:feddf
MODEL_NAME:wresnet-16-4
MODEL_LIST:{'resnet8':6,'wresnet-16-4':7,'resnet20':7}
NUM_CLIENTS:20
NUM_ROUNDS:30
FRACTION_FIT:0.4
FRACTION_EVALUATE:0.0
DATASET_NAME:cifar10
PARTITION_ALPHA:1.0
PARTITION_VAL_RATIO:0.1
BATCH_SIZE:512
LOCAL_EPOCHS:40
LOCAL_LR:0.01
DISTILL_BATCH_SIZE:32
SERVER_LR:0.005
USE_ADAPTIVE_LR:False
USE_ADAPTIVE_LR_ROUND:False
SERVER_STEPS:500
SERVER_EARLY_STEPS:1000
USE_EARLY_STOPPING:False
SERVER_STEPS_ADAPTIVE:False
SERVER_STEPS_ADAPTIVE_MIN:250
SERVER_STEPS_ADAPTIVE_INTERVAL:5
SEED:42
CUDA_DETERMINISTIC:False
USE_CROPS:True
IMG_NAME:ameyoko_small.jpg
DISTILL_DATASET:cifar100
DISTILL_ALPHA:1.0
NUM_DISTILL_IMAGES:5000
DISTILL_TRANSFORMS:v0
WARM_START:True
WARM_START_ROUNDS:1
WARM_START_INTERVAL:5
KMEANS_N_CLUSTER:1000
KMEANS_HEURISTICS:hard
KMEANS_MIXED_FACTOR:50-50
KMEANS_BALANCING:1.0
CONFIDENCE_THRESHOLD:0.9
CONFIDENCE_STRATEGY:top
CONFIDENCE_ADAPTIVE:False
CONFIDENCE_MAX_THRESH:0.5
CLIPPING_FACTOR:2.5
FEDPROX_FACTOR:2.0
FEDPROX_ADAPTIVE:False
USE_CLIPPING:True
USE_ENTROPY:True
USE_KMEANS:True
USE_FEDPROX:False
-----SETTINGS END-----
-----EXPERIMENT BEGINS-----
---------
Generating crops for FedDF
Namespace(img_size=32, batch_size=32, num_imgs=50000, threads=18, vflip=False, deg=30, shear=30, cropfirst=True, initcrop=0.5, scale=[500, 1], randinterp=False, debug=False, imgpath='./static/single_images/ameyoko_small.jpg', targetpath='/scratch-local/sunnys.3936876/1695816944_147873076', seed=42, img_per_thread=2777)
will save 50000 patches in /scratch-local/sunnys.3936876/1695816944_147873076/single_img_crops/crops
50000 took 1.04min with 18 threads
---------
Simulating feddf training
INFO simulate 2023-09-27 14:17:01,503 | simulate.py:51 | Python script started : simulate.py
DEBUG simulate 2023-09-27 14:17:01,504 | simulate.py:56 | Reading args from argument parser
INFO flwr 2023-09-27 14:19:09,210 | app.py:145 | Starting Flower simulation, config: ServerConfig(num_rounds=30, round_timeout=None)
2023-09-27 14:19:12,020	INFO worker.py:1529 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
INFO flwr 2023-09-27 14:19:13,052 | app.py:179 | Flower VCE: Ray initialized with resources: {'GPU': 1.0, 'memory': 103079215104.0, 'node:145.136.62.57': 1.0, 'object_store_memory': 61847529062.0, 'CPU': 18.0, 'accelerator_type:A100': 1.0}
INFO flwr 2023-09-27 14:19:13,052 | server.py:86 | Initializing global parameters
INFO flwr 2023-09-27 14:19:13,052 | server.py:266 | Using initial parameters provided by strategy
INFO flwr 2023-09-27 14:19:13,053 | server.py:88 | Evaluating initial parameters
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch-local/sunnys.3936876/1695816944_147873076/cifar-10-python.tar.gz
Extracting /scratch-local/sunnys.3936876/1695816944_147873076/cifar-10-python.tar.gz to /scratch-local/sunnys.3936876/1695816944_147873076
Generating unified cifar10 dataset
Class histogram for 0-th partition (alpha=1.0, 10 classes): [440 381 415  39  10 257 227 532  17 182]
INFO flwr 2023-09-27 14:19:17,054 | server.py:91 | initial parameters (loss, other metrics): 6.338353125, {'server_test_acc': 0.0972}
INFO flwr 2023-09-27 14:19:17,054 | server.py:101 | FL starting
DEBUG flwr 2023-09-27 14:19:33,176 | server.py:215 | fit_round 1: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=941075)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=941080)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=941079)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-09-27 14:21:04,616 | server.py:229 | fit_round 1 received 8 results and 0 failures
INFO flwr 2023-09-27 14:21:04,730 | fed_df.py:367 | Warm start at round 1
[2m[36m(launch_and_fit pid=941078)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=941081)[0m double free or corruption (fasttop)
INFO flwr 2023-09-27 14:21:04,939 | fed_df.py:465 | Performing server side distillation training...
[2m[36m(launch_and_fit pid=941075)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=941078)[0m Fitting Client 11
[2m[36m(launch_and_fit pid=941081)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=941076)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=941082)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=941079)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=941080)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=941077)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=941082)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=941077)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=941076)[0m malloc_consolidate(): invalid chunk size
E0927 14:21:07.692713097  940157 chttp2_transport.cc:1079]             ipv4:145.136.62.57:46183: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 60000ms
E0927 14:21:07.697891982  940157 chttp2_transport.cc:1079]             ipv4:145.136.62.57:46183: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 60000ms
E0927 14:21:07.697906797  940157 chttp2_transport.cc:1079]             ipv4:145.136.62.57:46183: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 60000ms
INFO flwr 2023-09-27 14:21:30,654 | fed_df.py:545 | Distillation training stopped at step number : 500
INFO flwr 2023-09-27 14:21:30,654 | fed_df.py:552 | Average fusion training loss : 0.3846640879809856, val accuracy : 0.26480000000000004, best val accuracy : 0.328
INFO flwr 2023-09-27 14:21:30,656 | common.py:35 | Avg. local train loss : 7.061515890620649, train acc : 0.5684958333333333
INFO flwr 2023-09-27 14:21:33,753 | server.py:116 | fit progress: (1, 3.9844980224609374, {'server_test_acc': 0.3357}, 136.69845019001514)
INFO flwr 2023-09-27 14:21:33,753 | server.py:163 | evaluate_round 1: no clients selected, cancel
DEBUG flwr 2023-09-27 14:21:49,518 | server.py:215 | fit_round 2: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=1045111)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1045110)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1045107)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1045115)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-09-27 14:23:23,375 | server.py:229 | fit_round 2 received 8 results and 0 failures
INFO flwr 2023-09-27 14:23:23,524 | fed_df.py:465 | Performing server side distillation training...
[2m[36m(launch_and_fit pid=1045112)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1045115)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=1045110)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=1045111)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=1045109)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=1045112)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=1045107)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=1045114)[0m Fitting Client 19
[2m[36m(launch_and_fit pid=1045113)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=1045114)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1045109)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1045113)[0m malloc_consolidate(): invalid chunk size
E0927 14:23:26.194138615 1034741 chttp2_transport.cc:1079]             ipv4:145.136.62.57:46183: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 120000ms
INFO flwr 2023-09-27 14:23:49,472 | fed_df.py:545 | Distillation training stopped at step number : 500
INFO flwr 2023-09-27 14:23:49,472 | fed_df.py:552 | Average fusion training loss : 0.4253120682835579, val accuracy : 0.26780000000000004, best val accuracy : 0.326
INFO flwr 2023-09-27 14:23:49,474 | common.py:35 | Avg. local train loss : 5.441490731015801, train acc : 0.7186458333333334
INFO flwr 2023-09-27 14:23:52,571 | server.py:116 | fit progress: (2, 7.960603344726563, {'server_test_acc': 0.3369}, 275.516574882)
INFO flwr 2023-09-27 14:23:52,571 | server.py:163 | evaluate_round 2: no clients selected, cancel
DEBUG flwr 2023-09-27 14:24:08,495 | server.py:215 | fit_round 3: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=1150301)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1150304)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1150307)[0m double free or corruption (fasttop)
DEBUG flwr 2023-09-27 14:25:37,943 | server.py:229 | fit_round 3 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=1150297)[0m malloc_consolidate(): invalid chunk size
INFO flwr 2023-09-27 14:25:38,101 | fed_df.py:465 | Performing server side distillation training...
[2m[36m(launch_and_fit pid=1150297)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=1150301)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=1150302)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=1150303)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=1150305)[0m Fitting Client 1
[2m[36m(launch_and_fit pid=1150307)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=1150304)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=1150306)[0m Fitting Client 0
E0927 14:25:38.624591213 1139187 chttp2_transport.cc:1079]             ipv4:145.136.62.57:46183: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 240000ms
[2m[36m(launch_and_fit pid=1150303)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1150306)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1150302)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1150305)[0m malloc_consolidate(): invalid chunk size
INFO flwr 2023-09-27 14:26:04,421 | fed_df.py:545 | Distillation training stopped at step number : 500
INFO flwr 2023-09-27 14:26:04,421 | fed_df.py:552 | Average fusion training loss : 0.4315514324307442, val accuracy : 0.41090909090909095, best val accuracy : 0.4638
INFO flwr 2023-09-27 14:26:04,423 | common.py:35 | Avg. local train loss : 4.920392791740596, train acc : 0.7768472222222221
INFO flwr 2023-09-27 14:26:07,561 | server.py:116 | fit progress: (3, 2.2879255187988283, {'server_test_acc': 0.4544}, 410.50658530101646)
INFO flwr 2023-09-27 14:26:07,561 | server.py:163 | evaluate_round 3: no clients selected, cancel
DEBUG flwr 2023-09-27 14:26:23,577 | server.py:215 | fit_round 4: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=1254637)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1254638)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1254636)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-09-27 14:28:00,323 | server.py:229 | fit_round 4 received 8 results and 0 failures
INFO flwr 2023-09-27 14:28:00,481 | fed_df.py:465 | Performing server side distillation training...
[2m[36m(launch_and_fit pid=1254630)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=1254634)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=1254636)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=1254637)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=1254639)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=1254641)[0m Fitting Client 11
[2m[36m(launch_and_fit pid=1254638)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=1254640)[0m Fitting Client 9
[2m[36m(launch_and_fit pid=1254641)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1254630)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1254639)[0m corrupted size vs. prev_size in fastbins
[2m[36m(launch_and_fit pid=1254640)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1254634)[0m double free or corruption (fasttop)
E0927 14:28:02.979112122 1373923 chttp2_transport.cc:1079]             ipv4:145.136.62.57:46183: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 480000ms
INFO flwr 2023-09-27 14:28:26,715 | fed_df.py:545 | Distillation training stopped at step number : 500
INFO flwr 2023-09-27 14:28:26,715 | fed_df.py:552 | Average fusion training loss : 0.3635991241633892, val accuracy : 0.4277454545454546, best val accuracy : 0.4792
INFO flwr 2023-09-27 14:28:26,717 | common.py:35 | Avg. local train loss : 4.889980957843363, train acc : 0.7789347222222223
INFO flwr 2023-09-27 14:28:29,851 | server.py:116 | fit progress: (4, 3.3148848388671874, {'server_test_acc': 0.4687}, 552.7973874090239)
INFO flwr 2023-09-27 14:28:29,852 | server.py:163 | evaluate_round 4: no clients selected, cancel
DEBUG flwr 2023-09-27 14:28:45,671 | server.py:215 | fit_round 5: strategy sampled 8 clients (out of 20)
DEBUG flwr 2023-09-27 14:30:12,299 | server.py:229 | fit_round 5 received 8 results and 0 failures
INFO flwr 2023-09-27 14:30:12,410 | fed_df.py:367 | Warm start at round 5
[2m[36m(launch_and_fit pid=1400772)[0m double free or corruption (fasttop)
INFO flwr 2023-09-27 14:30:12,590 | fed_df.py:465 | Performing server side distillation training...
[2m[36m(launch_and_fit pid=1400766)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=1400768)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=1400771)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=1400773)[0m Fitting Client 4
[2m[36m(launch_and_fit pid=1400772)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=1400769)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=1400770)[0m Fitting Client 15
[2m[36m(launch_and_fit pid=1400774)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=1400768)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1400773)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=1400774)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1400769)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1400770)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1400766)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1400771)[0m double free or corruption (fasttop)
INFO flwr 2023-09-27 14:30:38,911 | fed_df.py:545 | Distillation training stopped at step number : 500
INFO flwr 2023-09-27 14:30:38,912 | fed_df.py:552 | Average fusion training loss : 0.298272952914238, val accuracy : 0.5826727272727272, best val accuracy : 0.6118
INFO flwr 2023-09-27 14:30:38,913 | common.py:35 | Avg. local train loss : 4.553129510022699, train acc : 0.8120541666666666
INFO flwr 2023-09-27 14:30:42,056 | server.py:116 | fit progress: (5, 2.211155999755859, {'server_test_acc': 0.6009}, 685.0016618290101)
INFO flwr 2023-09-27 14:30:42,056 | server.py:163 | evaluate_round 5: no clients selected, cancel
DEBUG flwr 2023-09-27 14:30:57,877 | server.py:215 | fit_round 6: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=1507961)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1507953)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-09-27 14:32:31,698 | server.py:229 | fit_round 6 received 8 results and 0 failures
INFO flwr 2023-09-27 14:32:31,860 | fed_df.py:465 | Performing server side distillation training...
[2m[36m(launch_and_fit pid=1507953)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=1507954)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=1507961)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=1507958)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=1507962)[0m Fitting Client 9
[2m[36m(launch_and_fit pid=1507960)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=1507955)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=1507959)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=1507960)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1507958)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1507955)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1507962)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1507954)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=1507959)[0m malloc_consolidate(): invalid chunk size
E0927 14:32:36.189292494 1601416 chttp2_transport.cc:1079]             ipv4:145.136.62.57:46183: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 960000ms
E0927 14:32:36.189349001 1601416 chttp2_transport.cc:1079]             ipv4:145.136.62.57:46183: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 960000ms
ERROR: Unexpected segmentation fault encountered in worker.
 Traceback (most recent call last):
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1120, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/multiprocessing/queues.py", line 113, in get
    if not self._poll(timeout):
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/multiprocessing/connection.py", line 424, in _poll
    r = wait([self], timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1602834) is killed by signal: Segmentation fault. 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/home1/sunnys/thesis_23/single_image_fl/./simulate.py", line 297, in <module>
    fl.simulation.start_simulation(
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/flwr/simulation/app.py", line 196, in start_simulation
    hist = _fl(
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/flwr/server/app.py", line 201, in _fl
    hist = server.fit(num_rounds=config.num_rounds, timeout=config.round_timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/flwr/server/server.py", line 106, in fit
    res_fit = self.fit_round(server_round=current_round, timeout=timeout)
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/flwr/server/server.py", line 241, in fit_round
    ] = self.strategy.aggregate_fit(server_round, results, failures)
  File "/gpfs/home1/sunnys/thesis_23/single_image_fl/strategy/fed_df.py", line 382, in aggregate_fit
    parameters_aggregated, fusion_metrics = self.__fuse_models(global_parameters=old_parameters, preds=logits_aggregated,
  File "/gpfs/home1/sunnys/thesis_23/single_image_fl/strategy/fed_df.py", line 521, in __fuse_models
    for images2, labels2 in val_dataloader:
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1316, in _next_data
    idx, data = self._get_data()
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1282, in _get_data
    success, data = self._try_get_data()
  File "/home/sunnys/.conda/envs/single_image_fl/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1133, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 1602834) exited unexpectedly
malloc_consolidate(): invalid chunk size
srun: error: gcn57: task 0: Aborted
srun: Terminating StepId=3936876.1
-----EXPERIMENT ENDS-----
-----CLEANING UP DISK------
-----END-----

JOB STATISTICS
==============
Job ID: 3936876
Cluster: snellius
User/Group: sunnys/sunnys
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 18
CPU Utilized: 00:45:34
CPU Efficiency: 14.44% of 05:15:36 core-walltime
Job Wall-clock time: 00:17:32
Memory Utilized: 19.53 GB
Memory Efficiency: 16.28% of 120.00 GB
