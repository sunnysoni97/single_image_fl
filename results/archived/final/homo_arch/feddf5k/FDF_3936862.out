-----BEGIN-----
-----SETTINGS-----
TOTAL CROPS:5000
STRATEGY:feddf
MODEL_NAME:resnet20
MODEL_LIST:{'resnet8':6,'wresnet-16-4':7,'resnet20':7}
NUM_CLIENTS:20
NUM_ROUNDS:30
FRACTION_FIT:0.4
FRACTION_EVALUATE:0.0
DATASET_NAME:cifar10
PARTITION_ALPHA:1.0
PARTITION_VAL_RATIO:0.1
BATCH_SIZE:512
LOCAL_EPOCHS:40
LOCAL_LR:0.01
DISTILL_BATCH_SIZE:32
SERVER_LR:0.005
USE_ADAPTIVE_LR:False
USE_ADAPTIVE_LR_ROUND:False
SERVER_STEPS:500
SERVER_EARLY_STEPS:1000
USE_EARLY_STOPPING:False
SERVER_STEPS_ADAPTIVE:False
SERVER_STEPS_ADAPTIVE_MIN:250
SERVER_STEPS_ADAPTIVE_INTERVAL:5
SEED:42
CUDA_DETERMINISTIC:False
USE_CROPS:False
IMG_NAME:ameyoko_small.jpg
DISTILL_DATASET:cifar100
DISTILL_ALPHA:1.0
NUM_DISTILL_IMAGES:5000
DISTILL_TRANSFORMS:v0
WARM_START:True
WARM_START_ROUNDS:1
WARM_START_INTERVAL:5
KMEANS_N_CLUSTER:1000
KMEANS_HEURISTICS:hard
KMEANS_MIXED_FACTOR:50-50
KMEANS_BALANCING:1.0
CONFIDENCE_THRESHOLD:0.9
CONFIDENCE_STRATEGY:top
CONFIDENCE_ADAPTIVE:False
CONFIDENCE_MAX_THRESH:0.5
CLIPPING_FACTOR:2.5
FEDPROX_FACTOR:2.0
FEDPROX_ADAPTIVE:False
USE_CLIPPING:True
USE_ENTROPY:False
USE_KMEANS:False
USE_FEDPROX:False
-----SETTINGS END-----
-----EXPERIMENT BEGINS-----
Simulating feddf training
INFO simulate 2023-09-27 13:30:54,150 | simulate.py:51 | Python script started : simulate.py
DEBUG simulate 2023-09-27 13:30:54,150 | simulate.py:56 | Reading args from argument parser
INFO flwr 2023-09-27 13:31:15,441 | app.py:145 | Starting Flower simulation, config: ServerConfig(num_rounds=30, round_timeout=None)
2023-09-27 13:31:18,423	INFO worker.py:1529 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
INFO flwr 2023-09-27 13:31:19,464 | app.py:179 | Flower VCE: Ray initialized with resources: {'accelerator_type:A100': 1.0, 'object_store_memory': 61847529062.0, 'node:145.136.62.38': 1.0, 'memory': 103079215104.0, 'GPU': 1.0, 'CPU': 18.0}
INFO flwr 2023-09-27 13:31:19,465 | server.py:86 | Initializing global parameters
INFO flwr 2023-09-27 13:31:19,465 | server.py:266 | Using initial parameters provided by strategy
INFO flwr 2023-09-27 13:31:19,465 | server.py:88 | Evaluating initial parameters
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch-local/sunnys.3936862/1695814241_125688133/cifar-10-python.tar.gz
Extracting /scratch-local/sunnys.3936862/1695814241_125688133/cifar-10-python.tar.gz to /scratch-local/sunnys.3936862/1695814241_125688133
Generating unified cifar10 dataset
Class histogram for 0-th partition (alpha=1.0, 10 classes): [440 381 415  39  10 257 227 532  17 182]
Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch-local/sunnys.3936862/1695814241_125688133/cifar-100-python.tar.gz
Extracting /scratch-local/sunnys.3936862/1695814241_125688133/cifar-100-python.tar.gz to /scratch-local/sunnys.3936862/1695814241_125688133
INFO flwr 2023-09-27 13:31:23,246 | server.py:91 | initial parameters (loss, other metrics): 4.618544543457031, {'server_test_acc': 0.0864}
INFO flwr 2023-09-27 13:31:23,246 | server.py:101 | FL starting
DEBUG flwr 2023-09-27 13:31:27,303 | server.py:215 | fit_round 1: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=2605661)[0m malloc_consolidate(): invalid chunk size
DEBUG flwr 2023-09-27 13:32:45,712 | server.py:229 | fit_round 1 received 8 results and 0 failures
INFO flwr 2023-09-27 13:32:45,822 | fed_df.py:367 | Warm start at round 1
INFO flwr 2023-09-27 13:32:46,004 | fed_df.py:465 | Performing server side distillation training...
[2m[36m(launch_and_fit pid=2605664)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=2605660)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=2605662)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=2605666)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=2605665)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=2605661)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=2605659)[0m Fitting Client 3
[2m[36m(launch_and_fit pid=2605663)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=2605660)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2605663)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2605659)[0m malloc_consolidate(): invalid chunk size
E0927 13:32:46.799616886 2699920 chttp2_transport.cc:1079]             ipv4:145.136.62.38:54199: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 60000ms
[2m[36m(launch_and_fit pid=2605665)[0m corrupted size vs. prev_size in fastbins
[2m[36m(launch_and_fit pid=2605664)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2605666)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2605662)[0m malloc_consolidate(): invalid chunk size
INFO flwr 2023-09-27 13:33:14,716 | fed_df.py:545 | Distillation training stopped at step number : 500
INFO flwr 2023-09-27 13:33:14,716 | fed_df.py:552 | Average fusion training loss : 0.41126616752147677, val accuracy : 0.34381818181818186, best val accuracy : 0.4218
INFO flwr 2023-09-27 13:33:14,717 | common.py:35 | Avg. local train loss : 6.848650756292045, train acc : 0.5875027777777778
INFO flwr 2023-09-27 13:33:17,618 | server.py:116 | fit progress: (1, 2.8831070068359375, {'server_test_acc': 0.4226}, 114.37195255499682)
INFO flwr 2023-09-27 13:33:17,618 | server.py:163 | evaluate_round 1: no clients selected, cancel
DEBUG flwr 2023-09-27 13:33:21,196 | server.py:215 | fit_round 2: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=2714367)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2714364)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2714365)[0m double free or corruption (fasttop)
DEBUG flwr 2023-09-27 13:34:37,894 | server.py:229 | fit_round 2 received 8 results and 0 failures
INFO flwr 2023-09-27 13:34:38,055 | fed_df.py:465 | Performing server side distillation training...
[2m[36m(launch_and_fit pid=2714368)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=2714361)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=2714365)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=2714367)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=2714366)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=2714364)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=2714363)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=2714359)[0m Fitting Client 11
E0927 13:34:39.327049307 2700459 chttp2_transport.cc:1079]             ipv4:145.136.62.38:54199: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 120000ms
E0927 13:34:39.327108349 2700459 chttp2_transport.cc:1079]             ipv4:145.136.62.38:54199: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 120000ms
E0927 13:34:39.327121606 2700459 chttp2_transport.cc:1079]             ipv4:145.136.62.38:54199: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 120000ms
E0927 13:34:39.327130384 2700459 chttp2_transport.cc:1079]             ipv4:145.136.62.38:54199: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 120000ms
E0927 13:34:39.327138247 2700459 chttp2_transport.cc:1079]             ipv4:145.136.62.38:54199: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 120000ms
E0927 13:34:39.327145908 2700459 chttp2_transport.cc:1079]             ipv4:145.136.62.38:54199: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 120000ms
E0927 13:34:39.327153427 2700459 chttp2_transport.cc:1079]             ipv4:145.136.62.38:54199: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 120000ms
E0927 13:34:39.327161128 2700459 chttp2_transport.cc:1079]             ipv4:145.136.62.38:54199: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 120000ms
[2m[36m(launch_and_fit pid=2714363)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2714368)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2714361)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2714366)[0m malloc_consolidate(): invalid chunk size
INFO flwr 2023-09-27 13:35:04,346 | fed_df.py:545 | Distillation training stopped at step number : 500
INFO flwr 2023-09-27 13:35:04,347 | fed_df.py:552 | Average fusion training loss : 0.5281397232413292, val accuracy : 0.40047272727272726, best val accuracy : 0.4524
INFO flwr 2023-09-27 13:35:04,348 | common.py:35 | Avg. local train loss : 5.081061596795916, train acc : 0.7575277777777778
INFO flwr 2023-09-27 13:35:07,262 | server.py:116 | fit progress: (2, 3.5582326538085938, {'server_test_acc': 0.4599}, 224.01608946398483)
INFO flwr 2023-09-27 13:35:07,263 | server.py:163 | evaluate_round 2: no clients selected, cancel
DEBUG flwr 2023-09-27 13:35:10,824 | server.py:215 | fit_round 3: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=2819469)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2819468)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2819474)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2819478)[0m double free or corruption (fasttop)
DEBUG flwr 2023-09-27 13:36:28,424 | server.py:229 | fit_round 3 received 8 results and 0 failures
INFO flwr 2023-09-27 13:36:28,588 | fed_df.py:465 | Performing server side distillation training...
[2m[36m(launch_and_fit pid=2819469)[0m Fitting Client 5
[2m[36m(launch_and_fit pid=2819468)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=2819475)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=2819477)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=2819473)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=2819476)[0m Fitting Client 4
[2m[36m(launch_and_fit pid=2819478)[0m Fitting Client 16
[2m[36m(launch_and_fit pid=2819474)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=2819473)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2819477)[0m malloc_consolidate(): invalid chunk size
E0927 13:36:29.081472574 2910924 chttp2_transport.cc:1079]             ipv4:145.136.62.38:54199: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 240000ms
[2m[36m(launch_and_fit pid=2819476)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2819475)[0m malloc_consolidate(): invalid chunk size
INFO flwr 2023-09-27 13:36:54,835 | fed_df.py:545 | Distillation training stopped at step number : 500
INFO flwr 2023-09-27 13:36:54,836 | fed_df.py:552 | Average fusion training loss : 0.5728084896206855, val accuracy : 0.46832727272727276, best val accuracy : 0.5206
INFO flwr 2023-09-27 13:36:54,837 | common.py:35 | Avg. local train loss : 4.789469253830612, train acc : 0.7862777777777779
INFO flwr 2023-09-27 13:36:57,739 | server.py:116 | fit progress: (3, 3.000982928466797, {'server_test_acc': 0.5165}, 334.49266219499987)
INFO flwr 2023-09-27 13:36:57,739 | server.py:163 | evaluate_round 3: no clients selected, cancel
DEBUG flwr 2023-09-27 13:37:01,327 | server.py:215 | fit_round 4: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=2924549)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2924555)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=2924547)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2924552)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2924554)[0m double free or corruption (fasttop)
DEBUG flwr 2023-09-27 13:38:18,132 | server.py:229 | fit_round 4 received 8 results and 0 failures
INFO flwr 2023-09-27 13:38:18,294 | fed_df.py:465 | Performing server side distillation training...
[2m[36m(launch_and_fit pid=2924549)[0m Fitting Client 7
[2m[36m(launch_and_fit pid=2924552)[0m Fitting Client 1
[2m[36m(launch_and_fit pid=2924547)[0m Fitting Client 17
[2m[36m(launch_and_fit pid=2924551)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=2924555)[0m Fitting Client 0
[2m[36m(launch_and_fit pid=2924553)[0m Fitting Client 18
[2m[36m(launch_and_fit pid=2924554)[0m Fitting Client 13
[2m[36m(launch_and_fit pid=2924556)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=2924556)[0m malloc_consolidate(): invalid chunk size
E0927 13:38:18.878766510 2911197 chttp2_transport.cc:1079]             ipv4:145.136.62.38:54199: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 480000ms
[2m[36m(launch_and_fit pid=2924551)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=2924553)[0m malloc_consolidate(): invalid chunk size
INFO flwr 2023-09-27 13:38:44,614 | fed_df.py:545 | Distillation training stopped at step number : 500
INFO flwr 2023-09-27 13:38:44,615 | fed_df.py:552 | Average fusion training loss : 0.4929447439312935, val accuracy : 0.5702363636363637, best val accuracy : 0.598
INFO flwr 2023-09-27 13:38:44,616 | common.py:35 | Avg. local train loss : 4.236591022089124, train acc : 0.8405666666666666
INFO flwr 2023-09-27 13:38:47,542 | server.py:116 | fit progress: (4, 2.4137040100097655, {'server_test_acc': 0.5876}, 444.2956898059929)
INFO flwr 2023-09-27 13:38:47,542 | server.py:163 | evaluate_round 4: no clients selected, cancel
DEBUG flwr 2023-09-27 13:38:51,187 | server.py:215 | fit_round 5: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=3029364)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3029373)[0m double free or corruption (fasttop)
DEBUG flwr 2023-09-27 13:40:08,661 | server.py:229 | fit_round 5 received 8 results and 0 failures
[2m[36m(launch_and_fit pid=3029368)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3029371)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3029370)[0m malloc_consolidate(): invalid chunk size
INFO flwr 2023-09-27 13:40:08,774 | fed_df.py:367 | Warm start at round 5
[2m[36m(launch_and_fit pid=3029374)[0m double free or corruption (fasttop)
INFO flwr 2023-09-27 13:40:08,958 | fed_df.py:465 | Performing server side distillation training...
[2m[36m(launch_and_fit pid=3029368)[0m Fitting Client 8
[2m[36m(launch_and_fit pid=3029364)[0m Fitting Client 10
[2m[36m(launch_and_fit pid=3029371)[0m Fitting Client 6
[2m[36m(launch_and_fit pid=3029369)[0m Fitting Client 12
[2m[36m(launch_and_fit pid=3029373)[0m Fitting Client 11
[2m[36m(launch_and_fit pid=3029372)[0m Fitting Client 9
[2m[36m(launch_and_fit pid=3029370)[0m Fitting Client 2
[2m[36m(launch_and_fit pid=3029374)[0m Fitting Client 14
[2m[36m(launch_and_fit pid=3029369)[0m double free or corruption (fasttop)
E0927 13:40:09.570795232 3016116 chttp2_transport.cc:1079]             ipv4:145.136.62.38:54199: Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to "too_many_pings". Current keepalive time (before throttling): 960000ms
[2m[36m(launch_and_fit pid=3029372)[0m malloc_consolidate(): invalid chunk size
INFO flwr 2023-09-27 13:40:34,930 | fed_df.py:545 | Distillation training stopped at step number : 500
INFO flwr 2023-09-27 13:40:34,931 | fed_df.py:552 | Average fusion training loss : 0.44079626578092573, val accuracy : 0.6258181818181817, best val accuracy : 0.6472
INFO flwr 2023-09-27 13:40:34,932 | common.py:35 | Avg. local train loss : 4.248726666532457, train acc : 0.8399458333333335
INFO flwr 2023-09-27 13:40:37,915 | server.py:116 | fit progress: (5, 2.208463055419922, {'server_test_acc': 0.6382}, 554.668280576996)
INFO flwr 2023-09-27 13:40:37,915 | server.py:163 | evaluate_round 5: no clients selected, cancel
DEBUG flwr 2023-09-27 13:40:41,543 | server.py:215 | fit_round 6: strategy sampled 8 clients (out of 20)
[2m[36m(launch_and_fit pid=3134601)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3134594)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3134600)[0m double free or corruption (fasttop)
[2m[36m(launch_and_fit pid=3134602)[0m corrupted size vs. prev_size in fastbins
[2m[36m(launch_and_fit pid=3134595)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3134597)[0m malloc_consolidate(): invalid chunk size
[2m[36m(launch_and_fit pid=3134599)[0m malloc_consolidate(): invalid chunk size
slurmstepd: error: *** JOB 3936862 ON gcn38 CANCELLED AT 2023-09-27T16:15:55 DUE TO TIME LIMIT ***
slurmstepd: error: *** STEP 3936862.0 ON gcn38 CANCELLED AT 2023-09-27T16:15:55 DUE TO TIME LIMIT ***
*** SIGTERM received at time=1695824155 on cpu 21 ***
[failure_signal_handler.cc : 331] RAW: Signal 15 raised at PC=0x1485faca0ac1 while already in AbslFailureSignalHandler()
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: container_p_join: setns failed for /slurm/3936862/.ns: Invalid argument
slurmstepd: error: container_g_join(3936862): Invalid argument
PC: @     0x1485fb8e3d94  (unknown)  do_futex_wait.constprop.1
    @     0x1485fabcab20  (unknown)  (unknown)

JOB STATISTICS
==============
Job ID: 3936862
Cluster: snellius
User/Group: sunnys/sunnys
State: TIMEOUT (exit code 0)
Nodes: 1
Cores per node: 18
CPU Utilized: 00:33:10
CPU Efficiency: 1.11% of 2-01:37:12 core-walltime
Job Wall-clock time: 02:45:24
Memory Utilized: 16.72 GB
Memory Efficiency: 13.94% of 120.00 GB
